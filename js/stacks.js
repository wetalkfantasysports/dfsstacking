class Player{constructor(a){this.position=a[0],this.name=a[1],this.team=a[2],this.opponent=a[3],this.salary=Number(a[4]),this.projection=Number(a[5])}}let isTableRendered=!1,globalData=new Array,globalHeaders=[];var playerMap=new Map;function reset(){globalData=new Array,playerMap=new Map}function loadData(a){reset();var e="draftKings"===a?"https://raw.githubusercontent.com/wetalkfantasysports/dfsstacking/main/www/NFLDK.csv":"https://raw.githubusercontent.com/wetalkfantasysports/dfsstacking/main/www/NFLFD.csv";$.ajax({type:"GET",url:e,dataType:"text",success:function(a){allData=$.csv.toArrays(a);let e=[];console.log(allData),$.each(allData,function(a,t){if(a>0){var n=new Player(t);e.push(n),playerMap.has(n.position)||playerMap.set(n.position,new Map),playerMap.get(n.position).has(n.team)||playerMap.get(n.position).set(n.team,new Array),playerMap.get(n.position).get(n.team).push(n)}}),console.log(playerMap),globalData=e,buildStack("QB","WR")}})}function buildStack(a,e,t,n){let o=[];console.log(globalData);var l=this.playerMap.get(a);for(const[a,r]of l.entries())r.forEach(l=>{var r=this.playerMap.get(e).get(a);if(r)for(let c=0;c<r.length;c++){let u=r[c];if(t)if("Opp"===t){var s=l.opponent.indexOf("@")>-1?l.opponent.substring(1):l.opponent,p=this.playerMap.get("WR").get(s);for(let e=0;e<p.length;e++){let t=p[e],n=Math.round(100*(l.projection+u.projection+t.projection)/100),r=Math.round(100*(l.salary+u.salary+t.salary)/100);o.push([a,l.opponent,l.name,u.name,t.name,n,r,Math.round(n/r*1e3*100)/100])}}else{var i=this.playerMap.get(t).get(a);for(let r=e===t?c+1:0;r<i.length;r++){let e=i[r];if(n){s=l.opponent.indexOf("@")>-1?l.opponent.substring(1):l.opponent,p=this.playerMap.get("WR").get(s);for(let t=0;t<p.length;t++){let n=p[t],r=Math.round(100*(l.projection+u.projection+e.projection+n.projection)/100),s=Math.round(100*(l.salary+u.salary+e.salary+n.salary)/100);o.push([a,l.opponent,l.name,u.name,e.name,n.name,r,s,Math.round(r/s*1e3*100)/100])}}else{let t=Math.round(100*(l.projection+u.projection+e.projection)/100),n=Math.round(100*(l.salary+u.salary+e.salary)/100);o.push([a,l.opponent,l.name,u.name,e.name,t,n,Math.round(t/n*1e3*100)/100])}}}else{let e=Math.round(100*(l.projection+u.projection)/100),t=Math.round(100*(l.salary+u.salary)/100);o.push([a,l.opponent,l.name,u.name,e,t,Math.round(e/t*1e3*100)/100])}}});renderTable(o,a,e,t,n)}function renderTable(a,e,t,n,o){isTableRendered&&($("#myTable").DataTable().clear().destroy(),$("#myTable").empty()),columns=[{sTitle:"Team"},{sTitle:"Opponent"},{sTitle:`${e} Name`},{sTitle:`${t} Name`}],n&&columns.push({sTitle:`${n} Name`}),o&&columns.push({sTitle:`${o} Name`}),columns=columns.concat([{sTitle:"Combined Projection"},{sTitle:"Combined Salary"},{sTitle:"Value"}]),$("#myTable").DataTable({pageLength:50,rowDefs:[{className:"dt-body-center"}],aaData:a,aoColumns:columns}),isTableRendered=!0}$(document).ready(function(){loadData("draftKings")});